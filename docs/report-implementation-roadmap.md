# レポート機能実装ロードマップ

## 📋 現状把握（2024年実装時点）

### ✅ 実装済み
- **`src/types.ts`**: レポート機能用の型定義完了
  - `PeriodType`, `PeriodConfig`, `ReportFilter`
  - `TaskPerformance`, `DailyAchievement`, `TrendComparison`
  - `HighlightInfo`, `ReportData`
- **`src/state.ts`**: レポート用のデータ取得・分析関数完了
  - 日付範囲取得系関数（今週・先週・今月・先月）
  - パフォーマンス計算関数
  - 日別達成データ取得関数
  - 連続達成日数計算関数
- **`index.html`**: レポート画面のコンテナ追加済み（`#view-report`）
- **`src/main.ts`**: AppViewにreport追加済み

### 🚧 未実装
- **`src/ui/report.ts`**: レポート画面の実装（基本構造のみ）
- **`src/main.ts`**: showView関数でのレポート画面呼び出し
- **`src/style.css`**: レポート画面用のスタイル

---

## 🎯 実装手順

### **ステップ1: 基本画面の表示** ⏱️ 5分
**ファイル**: `src/main.ts`
**目的**: レポート画面への遷移を動作確認

**作業内容**:
- `showView`関数にレポート画面の処理を追加
- `renderReport(reportEl)`の呼び出し
- サイドバーの「レポート」ボタンクリックで画面表示確認

**完了条件**: レポートボタンをクリックして基本画面が表示される

---

### **ステップ2: レポート画面の基本構造** ⏱️ 30分
**ファイル**: `src/ui/report.ts`
**目的**: UI設計通りの基本レイアウトを実装

**作業内容**:
- 基本的なHTML構造の生成
- フィルターセクション（概要・タスク別タブ）
- 概要表示エリアの骨組み
- イベントリスナーの基本設定

**完了条件**: フィルタータブの切り替えが動作する

---

### **ステップ3: 概要画面のデータ表示** ⏱️ 1時間
**ファイル**: `src/ui/report.ts`
**目的**: 実際のタスクデータを使った概要表示

**作業内容**:
- `getAllTasksPerformance()`を使った習慣別パフォーマンス表示
- `getDailyAchievements()`を使った日別達成率の簡易表示
- `getBestDay()`を使ったハイライト情報の表示
- 空状態（タスクなし）の処理

**完了条件**: 実際のタスクデータが概要画面に表示される

---

### **ステップ4: タスクフィルター機能** ⏱️ 45分
**ファイル**: `src/ui/report.ts`
**目的**: 単一タスク選択とフィルター適用

**作業内容**:
- タスク選択画面の実装（ラジオボタン形式）
- 「適用」「リセット」ボタンの機能
- フィルター適用後の詳細画面切り替え
- 「フィルター変更」ボタンで概要画面に戻る機能

**完了条件**: タスクを選択して詳細画面に切り替わる

---

### **ステップ5: タスク詳細画面** ⏱️ 1.5時間
**ファイル**: `src/ui/report.ts`
**目的**: 選択タスクの詳細分析表示

**作業内容**:
- フィルター状態の表示
- 選択タスクの詳細テーブル表示（日付・完了状況）
- 統計カード（達成率・継続日数）の表示
- 簡易トレンド分析の表示
- タスク固有のハイライト表示

**完了条件**: 選択したタスクの詳細データが全て表示される

---

### **ステップ6: スタイリング** ⏱️ 1時間
**ファイル**: `src/style.css`
**目的**: UI設計通りの見た目を実装

**作業内容**:
- レポート画面用の基本CSS追加
- フィルタータブのスタイル（ダイアリーと統一）
- パフォーマンスバーのスタイル
- 統計カードのスタイル
- テーブルのスタイル
- レスポンシブ対応

**完了条件**: UI設計通りの見た目になる

---

### **ステップ7: 期間フィルター機能** ⏱️ 1時間
**ファイル**: `src/ui/report.ts`
**目的**: 期間選択機能の実装

**作業内容**:
- 期間選択タブ（今週・今月・カスタム）
- カスタム期間の日付入力
- 期間変更時のデータ更新
- 期間に応じた表示テキストの変更

**完了条件**: 期間を変更してデータが更新される

---

### **ステップ8: 最終調整・テスト** ⏱️ 30分
**ファイル**: 全体
**目的**: 品質向上と動作確認

**作業内容**:
- エラーハンドリングの追加
- エッジケース（データなし等）の対応
- モバイル表示の確認
- 全機能の動作テスト
- パフォーマンスの確認

**完了条件**: 全ての機能が安定して動作する

---

## 📊 実装見積もり

| ステップ | 所要時間 | 累計時間 |
|---------|---------|---------|
| ステップ1 | 5分 | 5分 |
| ステップ2 | 30分 | 35分 |
| ステップ3 | 1時間 | 1時間35分 |
| ステップ4 | 45分 | 2時間20分 |
| ステップ5 | 1.5時間 | 3時間50分 |
| ステップ6 | 1時間 | 4時間50分 |
| ステップ7 | 1時間 | 5時間50分 |
| ステップ8 | 30分 | **6時間20分** |

**総実装時間**: 約6-7時間（1-2日での完成予定）

---

## 🎯 推奨実装順序

1. **最優先**: ステップ1-3（基本表示とデータ表示）
2. **重要**: ステップ4-5（フィルター機能と詳細表示）
3. **仕上げ**: ステップ6-8（スタイリングと最終調整）

---

## 📝 実装メモ

### 技術的な注意点
- `state.ts`の関数は既に実装済みなので、UI側で呼び出すだけ
- エラーハンドリングは各ステップで適切に追加
- レスポンシブ対応はステップ6で一括実装

### テスト観点
- タスクがない状態での表示
- 大量のタスクがある状態での表示
- 期間変更時のデータ更新
- モバイル・デスクトップでの表示確認

### 将来の拡張予定
- グラフの視覚化強化
- より詳細なトレンド分析
- エクスポート機能
- 通知機能との連携

---

**作成日**: 2024年実装時  
**最終更新**: レポート機能実装完了時に更新予定
